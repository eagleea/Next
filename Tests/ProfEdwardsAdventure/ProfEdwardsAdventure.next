item laser{(string color = "Green", int damage = 10)}
item PDP_8{(int memory = 10)}
item not_windows_computer {(string OS = "Not-Windows")}
item fish_sandwich {(int portion_left = 100, string taste = "yummy")}
character prof_edwards {(int life = 10000, int awesomeness = 300, string slogan = "Add another layer of indirection!"), (laser, PDP_8, fish_sandwich)}

item dragon_book {(int damage = 5)}
character prof_aho{(int life = 20, int awesomeness = 20, string slogan = "I believe thats on page 42 of the Dragon Book!"), (dragon_book)}

character plt_mob {(int life = 99999, int damage = 6), ()}


character bill_gates {(int life = 2, string money = "$$$54 billion$$$", string slogan = "It just works"), ()}


location dragon_cave {(int depth = 500), (), (prof_edwards, prof_aho)}
location ucb {(), (), ()}
location mcdonalds {(), (), ()}
location taiwan {(), (), ()}

int itemNum = 0;

location columbia{(int temp = 20), (), (prof_edwards)}

start columbia end(prof_edwards.life < 0 or itemNum == 4) {
    output "Professor Edwards wants to implement a compiler but Professor Aho has the Dragon Book!";
    output "His items of compiler power have been stolen he must go forth and find them";
    
    choose (dcave, "Press d to go to the dragon cave", "d") 
           (tai, "Press t to go to Taiwan", "t") 
           (u, "Press u to go to UC Berkeley", "u") 
           (mcd, "Press m to go to McDonalds", "m") {
    
        when dcave {
            output "Off to the Dragon Cave to battle Aho";
        } next dragon_cave
    
        when tai {
            output "Off to Taiwan to the photo shoot";
        } next taiwan
    
        when u {
            output "Off to UC Berkeley!";
        } next ucb
    
        when mcd {
            output "Off to McDonalds for a fish burger";
        } next mcdonalds
    }
}
int moment = 0;

start dragon_cave end (prof_edwards.life < 0  or itemNum == 4) {
	if(moment == 0) then {
		output "You are in Prof. Aho's dragon cave!!";
		output "Aho is ready to fight you.. You must fight him to get his dragon book!!";
		output "... or maybe not?...";
		moment = 1;
	}
	else ;
		choose (fight, "Press a to fight him", "f")
			(runaway, "Press r to run away", "r")
			(ask, "Press a to ask him nicely", "a") {
			
			when fight{
				[? prob 70 { 
					output "behold aho, my shiny laser pointer";
					prof_aho.life = prof_aho.life - laser.damage;
					output "You caused aho a damage of:";
					output laser.damage;
					if (prof_aho.life <= 1) then
						drop prof_aho.dragon_book;
					else ;
				}
				prob 20 {
					output prof_aho.slogan;
					prof_edwards.life = prof_edwards.life - dragon_book.damage;
					output "Prof Aho hurt you this much:";
					output dragon_book.damage;
				}
				prob 10{
					output "wuah wuah wuah";
					output "Aho surrenders. You have won";
					output "YOu have won the dragon book";
					drop prof_aho.dragon_book;
					
				}?]

			if(exists dragon_cave.dragon_book) then{
			output prof_edwards.slogan;
			choose(grabbook, "Press g to grab", "g")
				(notgrab, "Press n not to grab", "n"){
				when grabbook { output "You have the dragon book!!";
					grab prof_edwards.dragon_book;
					output "Lets go back to columbia";
				} next columbia
				when notgrab  output "YOu dont have the dragon book!!!"; 
				 next dragon_cave
			}
			}
			else ;
			} next dragon_cave
			
			when runaway {
				output "You run away to columbia.. aaaawww";
				moment = 0;
				
			}next columbia
			

			when ask {
				drop prof_aho.dragon_book;
				grab prof_edwards.dragon_book;
				output "He actually just gave you the dragon book!";
				output "... after 3000 hours of telling you about Awk...";
				output "Anyway, time to go back to columbia and choose the next location";
				
			}next columbia
		}
	
		
					    
}

start ucb end (prof_edwards.life < 0 or itemNum == 4) {

}

start mcdonalds end  (prof_edwards.life < 0 or itemNum == 4) {

}

start taiwan end (prof_edwards.life < 0 or itemNum == 4) {

}
